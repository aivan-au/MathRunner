(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();const c=document.getElementById("game-container"),d=document.getElementById("player"),S=document.getElementById("start-screen"),L=document.getElementById("game-over-screen"),w=document.getElementById("final-score"),g=document.getElementById("game-over-title"),$=document.getElementById("start-btn"),C=document.getElementById("restart-btn");let e={isPlaying:!1,score:1,targetScore:1e3,lane:1,speed:3,gates:[],lastGateTime:0,gateSpawnInterval:1500,animationFrameId:null};const m=3,O=100/m,h=document.getElementById("player-score");$.addEventListener("click",I);C.addEventListener("click",I);window.addEventListener("keydown",T);function T(a){e.isPlaying&&(a.key==="ArrowLeft"||a.key==="a"||a.key==="A"?v(-1):(a.key==="ArrowRight"||a.key==="d"||a.key==="D")&&v(1))}function v(a){const o=e.lane+a;o>=0&&o<m&&(e.lane=o,f())}function f(){d.style.transform=`translateX(${e.lane*100}%)`}function I(){e.score=1,e.lane=1,e.speed=3,e.gates=[],e.isPlaying=!0,e.lastGateTime=performance.now(),x(),S.classList.add("hidden"),L.classList.add("hidden"),document.querySelectorAll(".gate").forEach(a=>a.remove()),f(),e.animationFrameId=requestAnimationFrame(P)}function E(a){e.isPlaying=!1,cancelAnimationFrame(e.animationFrameId),g.textContent=a?"You Won!":"Game Over",g.style.color=a?"var(--primary-color)":"var(--danger-color)",w.textContent=`Final Score: ${e.score}`,L.classList.remove("hidden")}function b(){const a=Math.floor(Math.random()*m),o=Math.random();let n,s;o<.4?(n="+",s=Math.floor(Math.random()*10)+1):o<.7?(n="-",s=Math.floor(Math.random()*10)+1):o<.9?(n="x",s=Math.random()<.5?2:3):(n="รท",s=Math.random()<.5?2:3);const t=document.createElement("div");t.classList.add("gate"),n==="x"?t.classList.add("multiply"):n==="รท"?t.classList.add("divide"):["+"].includes(n)?t.classList.add("positive"):t.classList.add("negative"),t.textContent=`${n}${s}`,t.style.left=`${a*O}%`,t.style.top="-100px",c.appendChild(t),e.gates.push({element:t,y:-100,lane:a,operation:n,value:s,passed:!1})}function P(a){if(!e.isPlaying)return;let o=[];a-e.lastGateTime>e.gateSpawnInterval&&(b(),e.lastGateTime=a,e.gateSpawnInterval>1e3&&(e.gateSpawnInterval-=10),e.speed+=.005),e.gates.forEach((n,s)=>{n.y+=e.speed,n.element.style.top=`${n.y}px`;const t=c.offsetHeight-100,r=t-60;!n.passed&&n.lane===e.lane&&n.y+80>r&&n.y<t&&(A(n.operation,n.value),n.passed=!0,n.element.style.opacity="0"),n.y>c.offsetHeight&&(o.push(s),n.element.remove())});for(let n=o.length-1;n>=0;n--)e.gates.splice(o[n],1);if(e.score>=e.targetScore){E(!0);return}else if(e.score<=0){E(!1);return}e.animationFrameId=requestAnimationFrame(P)}function A(a,o){switch(a){case"+":e.score+=o;break;case"-":e.score-=o;break;case"x":e.score*=o;break;case"รท":e.score=Math.floor(e.score/o);break}x(),d.animate([{transform:`translateX(${e.lane*100}%) scale(1)`},{transform:`translateX(${e.lane*100}%) scale(1.2)`},{transform:`translateX(${e.lane*100}%) scale(1)`}],{duration:200}),k(d.getBoundingClientRect(),["+","x"].includes(a)?a==="x"?"multiply":"positive":"negative")}function x(){h&&(h.textContent=e.score)}function k(a,o){const s=o==="positive"?"#00ff88":o==="multiply"?"#ffd700":"#ff0055",t=c.getBoundingClientRect(),r=a.left+a.width/2-t.left,i=a.top+a.height/2-t.top;for(let u=0;u<20;u++){const l=document.createElement("div");l.classList.add("particle"),l.style.backgroundColor=s,l.style.left=`${r}px`,l.style.top=`${i}px`;const p=Math.random()*Math.PI*2,y=Math.random()*100+50,M=Math.cos(p)*y,B=Math.sin(p)*y;l.style.setProperty("--tx",`${M}px`),l.style.setProperty("--ty",`${B}px`),c.appendChild(l),setTimeout(()=>l.remove(),800)}}f();
